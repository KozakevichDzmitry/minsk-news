(()=>{"use strict";function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function e(e,t){var n,o=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,n)),o}function l(o){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?e(Object(r),!0).forEach(function(t){var e,n;e=o,n=r[t=t],(t=function(t){t=function(t,e){if("object"!==a(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===e?String:Number)(t);n=n.call(t,e||"default");if("object"!==a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===a(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(r,t))})}return o}function i(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,a,i,l=[],c=!0,s=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=a.call(n)).done)&&(l.push(o.value),l.length!==e);c=!0);}catch(t){s=!0,r=t}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw r}}return l}}(t,e)||function(t,e){var n;if(t)return"string"==typeof t?o(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}jQuery(document).ready(function(n){function e(t,e){n.ajax({url:"/wp-admin/admin-ajax.php",data:l(l({},i),t),type:"POST",success:function(t){return e(t)}})}var o=n(".load-moree-btn"),r=(n.datepicker.setDefaults(n.datepicker.regional.ru),n(".datepicker-toggle .datepicker-reset-button")),a=null,i={action:"taxonomy_news_posts_load",load:15,offset:27,tax_query:{taxonomy:n(".load-moree-btn button").attr("data-tax-name"),field:"term_id",terms:n(".load-moree-btn button").attr("data-tax-id")}};r.on("click",function(){a=null,i.offset=0,e({date:null},function(t){var e;r.hide(),t&&(e=(t=JSON.parse(t)).posts,(t=t.count)<=i.offset+i.load?o.hide():o.show(),n(".main-content .ta-list").empty(),n(".main-content .ta-list").append(e),i.offset+=i.load,n(".load-moree-btn button").attr("data-all-posts",t))})}),o.on("click",function(){o.find("button").text("Загрузка..."),e(a?{date:a}:{},function(t){var e;t&&(e=(t=JSON.parse(t)).posts,(t=t.count)<=i.offset+i.load?o.hide():o.show(),n(".main-content .ta-list").append(e),i.offset+=i.load,n(".load-moree-btn button").attr("data-all-posts",t),o.find("button").text("Показать еще"))})}),n("#datepicker-tax-news-template").datepicker({showOn:"both",changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd",minDate:n("#datepicker-tax-news-template").data("min-date"),maxDate:n("#datepicker-tax-news-template").data("max-date"),onSelect:function(t){a=t,i.offset=0,e({date:t},function(t){var t=JSON.parse(t),e=t.posts,t=t.count;r.show(),t<=i.offset+i.load?n(".load-moree-btn").hide():n(".load-moree-btn").show(),n(".main-content .ta-list").empty(),n(".main-content .ta-list").append(e),i.offset+=i.load,n(".load-moree-btn button").attr("data-all-posts",t)})}})}),jQuery(function(e){var n=e(".main-content .post:last")[0],o={action:"loadmorenews",offset:3,exclude:e(".main-content").attr("id"),load:9},r=new IntersectionObserver(function(t){i(t,1)[0].isIntersecting&&e.ajax({type:"POST",url:ajax.ajaxurl,data:o,beforeSend:function(){e(".loading-posts").addClass("active")},success:function(t){t?(o.offset+=o.load,e(n).after(t),r.unobserve(n),n=e(".main-content .post:last")[0],e(".loading-posts").removeClass("active"),r.observe(n)):(r.unobserve(n),e(".loading-posts").removeClass("active"))}})},{root:null,rootMargin:"10px",threshold:.1});n&&r.observe(n)})})();