(()=>{"use strict";jQuery(document).ready(function(o){function c(e,t){o(e).find("[data-postid=".concat(t,"]")).addClass("new-post")}function i(e){var t=e.target.dataset.postid;n["".concat(t)]&&clearTimeout(n["".concat(t)]),n["".concat(t)]=setTimeout(function(){document.querySelectorAll('[data-postid="'.concat(t,'"]')).forEach(function(e){e.removeEventListener("mouseenter",i)}),document.querySelectorAll('[data-postid="'.concat(t,'"]')).forEach(function(e){e.removeEventListener("mouseleave",d)}),delete s[t.toString()],r()},a)}var t,e=new autobahn.Connection({url:"wss://minsknews.by/socket/",realm:"realm1"}),s={},n={},a=1e3,r=function(e){e&&(s[e.toString()]=!0),t=Object.keys(s).length||"",o("#added_news_counter").text(t)},d=function(e){e=e.target.dataset.postid;clearTimeout(n["".concat(e)])};e.onopen=function(e){e.subscribe("newspaper",function(e){var n=JSON.parse(e[0]);n.tax.forEach(function(e){var t=o("#main-content > div.pdf-attachments.".concat(e," .pdf-attachments-item[data-postid=").concat(n.postID,"]"));0===t.length?((t=o("#main-content > div.pdf-attachments.".concat(e))).find(".pdf-attachments-item").last().remove(),t.prepend(o(n.data))):t.replaceWith(o(n.data))})}),e.subscribe("news",function(e){for(var t in s)document.querySelectorAll('[data-postid="'.concat(t,'"]')).forEach(function(e){e.removeEventListener("mouseenter",i)}),document.querySelectorAll('[data-postid="'.concat(t,'"]')).forEach(function(e){e.removeEventListener("mouseleave",d)});var n,e=JSON.parse(e[0]),a=e[0].postID;for(n in e.forEach(function(e){var t,n,i=document.createElement("div");i.innerHTML=e.data,c(i,a),"glavnoe"===e.cat?(t=o(".glavnoe .news-template-line[data-postid=".concat(e.postID,"]")),n=o(".glavnoe"),0===t.length?(o(n).children().last().remove(),n.prepend(i.innerHTML)):t.replaceWith(i.innerHTML)):"primary"===e.cat?((n=o(".primary")).addClass("new-post"),o(n).children(".news-template-image").replaceWith(i.innerHTML)):"main"===e.cat?(t=o("#main-content div.long-news-list .news-template-line[data-postid=".concat(e.postID,"]")),n=o("#main-content > div.main-news-cat.box-line-gap > div.long-news-list > #timeline-main-block"),0===t.length?n.prepend(i.innerHTML):t.replaceWith(o(i.innerHTML))):"feed"===e.cat?(n=o("footer div.timeline__news-list-expanded .post-line[data-postid=".concat(e.postID,"]")),t=o("footer .timeline__news-list-expanded"),0===n.length?o(t).find(">:nth-child(3)").before(i.innerHTML):n.replaceWith(o(i.innerHTML)),r(a)):"glavnoe-feed"===e.cat?(t=o("footer div.timeline__news-list-collapsed .timeline-news-template[data-postid=".concat(e.postID,"]")),n=o("footer div.timeline__news-list-collapsed"),0===t.length?(o(n).find(">:last-child").remove(),o(n).prepend(i.innerHTML)):t.replaceWith(o(i.innerHTML)),r(a)):(i.querySelector(".topic-bar").remove(),o(".box-column-gap.".concat(e.cat)).replaceWith(i.innerHTML))}),s)document.querySelectorAll('[data-postid="'.concat(n,'"]')).forEach(function(e){e.addEventListener("mouseenter",i)}),document.querySelectorAll('[data-postid="'.concat(n,'"]')).forEach(function(e){e.addEventListener("mouseleave",d)})}),e.subscribe("district",function(e){var t=JSON.parse(e[0]).data,n=JSON.parse(e[0]).slug,i=JSON.parse(e[0]).postID,a=document.createElement("div");n.forEach(function(e){a.innerHTML=t,c(a,i),o(".district-preview > div.district-item.".concat(e," .district-news")).replaceWith(a.innerHTML)})}),e.subscribe("video",function(e){var t=document.createElement("div"),e=JSON.parse(e[0]),n=e.postID,i=o(".video-news-template .box[data-postid=".concat(n,"]")),a=o(".video-news-template");t.innerHTML=e.data,c(t,n),0===i.length?(o(a).children().last().remove(),a.prepend(t.innerHTML)):i.replaceWith(t.innerHTML)}),e.subscribe("authors_column",function(e){e=JSON.parse(e[0]);o(".author-column-slider-card[data-id=".concat(e.author_id,"] .content-container")).replaceWith(e.data)}),e.subscribe("event",function(e){e=JSON.parse(e[0]);$page=o("#events"),$body=o("body"),document.querySelector("#events div.event_slider"),$page&&$body.hasClass("postid-".concat(e.post_id))&&(o("#events div.event_slider").slick("unslick"),o("#events div.event_slider").replaceWith(e.data.slider),o("#events div.event_slider").slick({dots:!0,infinite:!0,speed:300,slidesToShow:4,slidesToScroll:1,responsive:[{breakpoint:1360,settings:{slidesToShow:3,slidesToScroll:1,infinite:!0,dots:!0}},{breakpoint:600,settings:{arrows:!1,centerMode:!0,centerPadding:"40px",infinite:!0,slidesToShow:1,slidesToScroll:1}}]}),o("#events div.main-content > div.events-content").replaceWith(e.data.messages))})},e.open()})})();