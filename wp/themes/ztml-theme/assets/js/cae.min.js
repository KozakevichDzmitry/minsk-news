(()=>{"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function e(e,t){var a,n=Object.keys(e);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(e),t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)),n}function c(n){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?e(Object(o),!0).forEach(function(t){var e,a;e=n,a=o[t=t],(t=function(t){t=function(t,e){if("object"!==r(t)||null===t)return t;var a=t[Symbol.toPrimitive];if(void 0===a)return("string"===e?String:Number)(t);a=a.call(t,e||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"===r(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(o,t))})}return n}jQuery(document).ready(function(d){function p(t){var e=Math.floor(t/60),t=parseInt(t-60*e);return{minutes:e<10?"0"+e:e,seconds:t<10?"0"+t:t}}var t=d(".cae .cards-list"),f=[];function y(t){var e=t.min,a=t.max,n=t.value;t.style.backgroundSize=100*(n-e)/(a-e)+"% 100%"}d(".cae .cards-list .mn-player").each(function(t,e){d(e).find("input[type='range']").each(function(t,e){y(e)});var a=d(e).find("audio")[0],n=d(e).find("#time")[0];a.addEventListener("canplaythrough",function(){var t=p(a.duration);n.textContent="00:00 — ".concat(t.minutes||"00",":").concat(t.seconds||"00")},{once:!0})});var m="PLAY_TYPE_EVENT",b="VOLUME_TYPE_EVENT",v="TRACK_TYPE_EVENT";t.click(function(t){var i,e,a,n,o,r,c,l,s,t=d(t.target),u=(t.closest(".card-item__footer").length&&((u=t.closest(".card-item").find(".card-item__description")).hasClass("nowrap")?u.removeClass("nowrap"):u.addClass("nowrap")),t.closest(".mn-player"));u.length&&(e=u[0],(i=f.find(function(t){return e===t.el}))||(c=u.find(".player-controls__play-btn"),a=u.find(".player-controls__volume input[type='range']"),n=u.find(".mn-player__track-bar input[type='range']"),r=u.find("#time"),o=u.find("audio"),u={el:u[0],audio:o[0],time:n[0],timer:r[0],playBtn:c[0],trackBar:n[0],volume:a[0],audioTrackInterval:null,isPlay:!1},f.push(u),i=u),y(i.volume),y(i.trackBar),r=d((o=t).closest(".player-controls__play-btn")[0]).hasClass("player-controls__play-btn"),c=d(o.closest(".player-controls__volume")[0]).hasClass("player-controls__volume"),o=d(o.closest(".mn-player__track-bar")[0]).hasClass("mn-player__track-bar"),(n=r?m:c?b:o?v:"INIT_TYPE_EVENT")==m&&(s=i,f.forEach(function(t){t.el!=s.el&&(d(t.el).find(".cae_play_icon").css("display","inline-block"),d(t.el).find(".cae_pause_icon").css("display","none"),t.isPlay=!1,t.audio.pause(),clearInterval(t.audioTrackInterval))}),i.isPlay=!i.isPlay,i.isPlay&&(l=p(i.audio.duration),i.audio.play(),d(i.playBtn).find(".cae_play_icon").css("display","none"),d(i.playBtn).find(".cae_pause_icon").css("display","inline-block"),i.audioTrackInterval=setInterval(function(){return e=l,a=(t=i).audioTrackInterval,n=t.audio,o=t.trackBar,t=t.timer,r=p(n.currentTime),n.currentTime>=n.duration?(clearInterval(a),n.currentTime=0,n.pause()):(o.value=Math.floor(n.currentTime/n.duration*100),t.textContent="".concat(r.minutes,":").concat(r.seconds," - ").concat(e.minutes||"00",":").concat(e.seconds||"00")),y(o),void y(n);var t,e,a,n,o,r},1e3)),i.isPlay||(i.audio.pause(),d(i.playBtn).find(".cae_play_icon").css("display","inline-block"),d(i.playBtn).find(".cae_pause_icon").css("display","none"),clearInterval(i.audioTrackInterval))),n==b&&(i.audio.volume=i.volume.value/100,y(i.volume)),n==v)&&(i.audio.play(),i.audio.currentTime=i.trackBar.value*i.audio.duration/100,i.audio.pause(),y(i.trackBar))})}),jQuery(document).ready(function(a){function e(t,e){a.ajax({url:"/wp-admin/admin-ajax.php",data:c(c({},i),t),type:"POST",success:function(t){return e(t)}})}var n=a(".load-moree-btn"),o=(a.datepicker.setDefaults(a.datepicker.regional.ru),a(".datepicker-toggle .datepicker-reset-button")),r=null,i={action:"taxonomy_cae_load",load:27,offset:27,post_type:"cae"};o.on("click",function(){r=null,i.offset=0,e({date:null},function(t){var e;o.hide(),t&&(e=(t=JSON.parse(t)).posts,(t=t.count)<=i.offset+i.load?n.hide():n.show(),a(".main-content .cards-list").empty(),a(".main-content .cards-list").append(e),i.offset+=i.load,a(".load-moree-btn button").attr("data-all-posts",t))})}),n.on("click",function(){n.find("button").text("Загрузка..."),e(r?{date:r}:{},function(t){var e;t&&(e=(t=JSON.parse(t)).posts,(t=t.count)<=i.offset+i.load?n.hide():n.show(),a(".main-content .cards-list").append(e),i.offset+=i.load,a(".load-moree-btn button").attr("data-all-posts",t),n.find("button").text("Показать еще"))})}),a("#datepicker-take-actions-template").datepicker({showOn:"both",changeYear:!0,changeMonth:!0,dateFormat:"yy-mm-dd",minDate:a("#datepicker-take-actions-template").data("min-date"),maxDate:a("#datepicker-take-actions-template").data("max-date"),onSelect:function(t){r=t,i.offset=0,e({date:t},function(t){var t=JSON.parse(t),e=t.posts,t=t.count;o.show(),t<=i.offset+i.load?a(".load-moree-btn").hide():a(".load-moree-btn").show(),a(".main-content .cards-list").empty(),a(".main-content .cards-list").append(e),i.offset+=i.load,a(".load-moree-btn button").attr("data-all-posts",t)})}})})})();