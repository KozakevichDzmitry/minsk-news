(()=>{"use strict";jQuery(document).ready(function(i){i.datepicker.setDefaults(i.datepicker.regional.ru);let n=document.querySelector(".long-news-list .timeline-main .news-template-line:last-child"),t=(i(n).addClass("eof"),null);const a=i(".datepicker-toggle .datepicker-reset-button"),s={action:"main_timline_tape_load",load:10,offset:10,taxonomy:"news-list",field:"slug",terms:"feed"},o=new IntersectionObserver(([e])=>{e.isIntersecting&&r(t?{date:t}:{},e=>{i(".long-news-list .timeline-main .news-template-line:last-child").removeClass("eof"),e&&l(o,e)})},{root:null,rootMargin:"10px",threshold:.1}),r=(a.on("click",()=>{t=null,s.offset=0,document.querySelector(".long-news-list .timeline-main").scrollTo({top:0,behavior:"smooth"}),r({date:null},e=>{a.hide(),i(".long-news-list .timeline-main").empty(),e&&l(o,e)})}),(e,t)=>i.ajax({url:"/wp-admin/admin-ajax.php",data:{...s,...e},type:"POST",success:e=>t(e)})),l=(i("#datepicker-all-news").datepicker({showOn:"both",changeMonth:!0,changeYear:!0,dateFormat:"yy-mm-dd",minDate:i("#datepicker-all-news").data("min-date"),maxDate:i("#datepicker-all-news").data("max-date"),onSelect:e=>{t=e,s.offset=0,document.querySelector(".long-news-list .timeline-main").scrollTo({top:0,behavior:"smooth"}),r({date:e},e=>{a.show(),i(".long-news-list .timeline-main").empty(),e&&l(o,e)})}}),(e,t)=>{t=i(t);i(t[t.length-1]).addClass("eof"),i(".long-news-list .timeline-main").append(t),e.unobserve(n),n=document.querySelector(".long-news-list .timeline-main .news-template-line.eof"),e.observe(n),s.offset+=s.load});o.observe(n)}),jQuery(document).ready(function(e){e(".swiper-container.two").length&&new Swiper(".swiper-container.two",{pagination:".swiper-pagination",paginationClickable:!0,clickable:!0,paginationBulletRender:function(e,t){return'<span class="swiper-pagination-bullet"></span>'},effect:"coverflow",autoHeight:!1,loop:!1,centeredSlides:!0,slidesPerView:"auto",spaceBetween:0,initialSlide:2,coverflow:{rotate:0,stretch:100,depth:0,modifier:1.5,slideShadows:!1},breakpoints:{576:{spaceBetween:700},768:{initialSlide:1,spaceBetween:0}}})}),jQuery(document).ready(function(n){const e=n(".district-preview"),a=n(".district-tablet-template .districts-list-container .district-item");let s=0;if(e.length&&a.length){const i=()=>{let e=0;n(".district-preview>.district-item > div").each(function(){n(this).height()>e&&(e=n(this).height())}),n(".district-preview>.district-item").each(function(){n(this).height(e<100?550:e)})},o=e.find(".district-item");e.click(e=>{i(),$target=n(e.target),0<($caption=$target.closest(".district-item")).length&&(o.removeClass("active"),s=$caption.data("id"),$caption.addClass("active"),a.removeClass("active"),n(a[s]).addClass("active")),i()});var t=()=>{n(window).width()<768?0==n(".district-preview").hasClass(".slick-initialized")&&(n(".district-preview").find(".district-item").addClass("active"),e.not(".slick-initialized").slick({slidesToShow:1,arrows:!1,arrows:!0,dots:!0,prevArrow:n("#js-features-arrows__prev"),nextArrow:n("#js-features-arrows__next")}),e.slick("slickGoTo",s),e.on("afterChange",function(e,t,i){n(a[s]).removeClass("active"),s=i,n(a[s]).addClass("active")})):(e.hasClass("slick-initialized")&&e.slick("unslick"),e.find(".district-item").removeClass("active"),n(e.find(".district-item")[s]).addClass("active")),i()};n(".districts-list ul").on("click",e=>{$target=n(e.target),0<($caption=$target.closest(".district-caption")).length&&(n(a[s]).removeClass("active"),s=$caption.data("id"),n(a[s]).addClass("active")),i()}),t(),n(window).on("resize",t)}}),jQuery(document).ready(function(s){var e=new autobahn.Connection({url:"wss://minsknews.by/socket/",realm:"realm1"});let n={},t,i={},a=1e3;const o=e=>{e&&(n[e.toString()]=!0),t=Object.keys(n).length||"",s("#added_news_counter").text(t)},r=(e,t)=>{s(e).find(`[data-postid=${t}]`).addClass("new-post")},l=e=>{const t=e.target.dataset.postid;i[""+t]&&clearTimeout(i[""+t]),i[""+t]=setTimeout(()=>{document.querySelectorAll(`[data-postid="${t}"]`).forEach(e=>{e.removeEventListener("mouseenter",l)}),document.querySelectorAll(`[data-postid="${t}"]`).forEach(e=>{e.removeEventListener("mouseleave",d)}),delete n[t.toString()],o()},a)},d=e=>{e=e.target.dataset.postid;clearTimeout(i[""+e])};e.onopen=function(e){e.subscribe("newspaper",e=>{const i=JSON.parse(e[0]);i.tax.forEach(e=>{let t=s(`#main-content > div.pdf-attachments.${e} .pdf-attachments-item[data-postid=${i.postID}]`);0===t.length?((t=s("#main-content > div.pdf-attachments."+e)).find(".pdf-attachments-item").last().remove(),t.prepend(s(i.data))):t.replaceWith(s(i.data))})}),e.subscribe("news",e=>{for(var t in n)document.querySelectorAll(`[data-postid="${t}"]`).forEach(e=>{e.removeEventListener("mouseenter",l)}),document.querySelectorAll(`[data-postid="${t}"]`).forEach(e=>{e.removeEventListener("mouseleave",d)});var i,e=JSON.parse(e[0]);const a=e[0].postID;for(i in e.forEach(e=>{var t,i,n=document.createElement("div");n.innerHTML=e.data,r(n,a),"glavnoe"===e.cat?(t=s(`.glavnoe .news-template-line[data-postid=${e.postID}]`),i=s(".glavnoe"),0===t.length?(s(i).children().last().remove(),i.prepend(n.innerHTML)):t.replaceWith(n.innerHTML)):"primary"===e.cat?((i=s(".primary")).addClass("new-post"),s(i).children(".news-template-image").replaceWith(n.innerHTML)):"main"===e.cat?(t=s(`#main-content div.long-news-list .news-template-line[data-postid=${e.postID}]`),i=s("#main-content > div.main-news-cat.box-line-gap > div.long-news-list > #timeline-main-block"),0===t.length?i.prepend(n.innerHTML):t.replaceWith(s(n.innerHTML))):"feed"===e.cat?(i=s(`footer div.timeline__news-list-expanded .post-line[data-postid=${e.postID}]`),t=s("footer .timeline__news-list-expanded"),0===i.length?s(t).find(">:nth-child(3)").before(n.innerHTML):i.replaceWith(s(n.innerHTML)),o(a)):"glavnoe-feed"===e.cat?(t=s(`footer div.timeline__news-list-collapsed .timeline-news-template[data-postid=${e.postID}]`),i=s("footer div.timeline__news-list-collapsed"),0===t.length?(s(i).find(">:last-child").remove(),s(i).prepend(n.innerHTML)):t.replaceWith(s(n.innerHTML)),o(a)):(n.querySelector(".topic-bar").remove(),s(".box-column-gap."+e.cat).replaceWith(n.innerHTML))}),n)document.querySelectorAll(`[data-postid="${i}"]`).forEach(e=>{e.addEventListener("mouseenter",l)}),document.querySelectorAll(`[data-postid="${i}"]`).forEach(e=>{e.addEventListener("mouseleave",d)})}),e.subscribe("district",e=>{const t=JSON.parse(e[0]).data;var i=JSON.parse(e[0]).slug;const n=JSON.parse(e[0]).postID;let a=document.createElement("div");i.forEach(e=>{a.innerHTML=t,r(a,n),s(`.district-preview > div.district-item.${e} .district-news`).replaceWith(a.innerHTML)})}),e.subscribe("video",e=>{var t=document.createElement("div"),e=JSON.parse(e[0]),i=e.postID,n=s(`.video-news-template .box[data-postid=${i}]`),a=s(".video-news-template");t.innerHTML=e.data,r(t,i),0===n.length?(s(a).children().last().remove(),a.prepend(t.innerHTML)):n.replaceWith(t.innerHTML)}),e.subscribe("authors_column",e=>{e=JSON.parse(e[0]);s(`.author-column-slider-card[data-id=${e.author_id}] .content-container`).replaceWith(e.data)}),e.subscribe("event",e=>{e=JSON.parse(e[0]);$page=s("#events"),$body=s("body"),document.querySelector("#events div.event_slider"),$page&&$body.hasClass("postid-"+e.post_id)&&(s("#events div.event_slider").slick("unslick"),s("#events div.event_slider").replaceWith(e.data.slider),s("#events div.event_slider").slick({dots:!0,infinite:!0,speed:300,slidesToShow:4,slidesToScroll:1,responsive:[{breakpoint:1360,settings:{slidesToShow:3,slidesToScroll:1,infinite:!0,dots:!0}},{breakpoint:600,settings:{arrows:!1,centerMode:!0,centerPadding:"40px",infinite:!0,slidesToShow:1,slidesToScroll:1}}]}),s("#events div.main-content > div.events-content").replaceWith(e.data.messages))})},e.open()})})();